<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
"http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
<section id="JCR.synonymProvider">
  <title>Synonym Provider</title>

  <para>Find all mix:title nodes where title contains synonyms to 'fast'
  word.</para>

  <note>
    <para>See also about synonym provider configuration in <link linkend="JCR.SearchingRepositoryContent">Searching Repository
    Content</link>.</para>
  </note>

  <para>The synonym provider must be configured in <filename>indexing-configuration.xml</filename>:</para>

  <programlisting language="xml">&lt;query-handler class="org.exoplatform.services.jcr.impl.core.query.lucene.SearchIndex"&gt;
   &lt;properties&gt;
      ...
      &lt;property name="synonymprovider-class" value="org.exoplatform.services.jcr.impl.core.query.lucene.PropertiesSynonymProvider" /&gt;
      &lt;property name="synonymprovider-config-path" value="../../synonyms.properties" /&gt;
      ...
   &lt;/properties&gt;
&lt;/query-handler&gt;</programlisting>

  <para>The <filename>synonym.properties</filename> file contains next synonyms list:</para>

  <programlisting>ASF=Apache Software Foundation
quick=fast
sluggish=lazy</programlisting>

  <para xml:id="JCR.synonymProvider.RepositoryStructure">
    <citetitle>
      <emphasis role="bold">Repository structure</emphasis>
    </citetitle>
  </para>

    <para>Repository contains mix:title nodes, where jcr:title has different
    values.</para>

    <itemizedlist>
      <listitem>
        <para>root</para>

        <itemizedlist>
          <listitem>
            <para>document1 (mix:title) jcr:title="The quick brown fox jumps
            over the lazy dog."</para>
          </listitem>
        </itemizedlist>
      </listitem>
    </itemizedlist>

  <para xml:id="JCR.synonymProvider.QueryExecution">
    <citetitle>
      <emphasis role="bold">Query execution</emphasis>
    </citetitle>
  </para>

    <para><emphasis role="bold">SQL</emphasis></para>

    <programlisting language="java">// make SQL query
QueryManager queryManager = workspace.getQueryManager();
// create query
String sqlStatement = "SELECT * FROM mix:title WHERE CONTAINS(jcr:title, '~fast')";
Query query = queryManager.createQuery(sqlStatement, Query.SQL);
// execute query and fetch result
QueryResult result = query.execute();</programlisting>

    <para><emphasis role="bold">XPath</emphasis></para>

    <programlisting language="java">// make XPath query
QueryManager queryManager = workspace.getQueryManager();
// create query
String xpathStatement = "//element(*,mix:title)[jcr:contains(@jcr:title, '~fast')]";
Query query = queryManager.createQuery(xpathStatement, Query.XPATH);
// execute query and fetch result
QueryResult result = query.execute();</programlisting>

  <para xml:id="JCR.synonymProvider.FetchingResult">
    <citetitle>
      <emphasis role="bold">Fetching result</emphasis>
    </citetitle>
  </para>

    <para>Let's get nodes:</para>

    <programlisting language="java">NodeIterator it = result.getNodes();

if(it.hasNext())
{
   Node findedNode = it.nextNode();
}</programlisting>

    <para>NodeIterator will return expected document1. This is a purpose of
    synonym providers. Find by specified word, but return by all synonyms
    to.</para>
</section>
