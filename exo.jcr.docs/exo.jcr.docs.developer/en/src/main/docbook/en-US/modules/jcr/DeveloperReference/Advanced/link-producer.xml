<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
"http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
<!--3.2.4. Link producer service-->
<section id="JCR.LinkProducerService" role="NotInToc">
  <title>Link producer service</title>

  <para>Link Producer Service - a simple service, which generates an <filename>.lnk</filename>
  file, that is compatible with the Microsoft link file format. It is an
  extension of the REST Framework library and is included into the WebDav
  service. On dispatching a GET request the service generates the content of
  an <filename>.lnk</filename> file, which points to a JCR resource via WebDav.</para>

  <para>Link Producer has a simple configuration as described below:</para>

  <programlisting language="xml">&lt;component&gt;
  &lt;key&gt;org.exoplatform.services.webdav.lnkproducer.LnkProducer&lt;/key&gt;
  &lt;type&gt;org.exoplatform.services.webdav.lnkproducer.LnkProducer&lt;/type&gt;
&lt;/component&gt;</programlisting>

  <para>When using JCR the resource can be addressed by WebDav reference
  (href) like
  <uri>http://host:port/rest/jcr/repository/workspace/somenode/somefile.extention</uri>
  , the link servlet must be called for this resource by several hrefs, like
  <uri>http://localhost:8080/rest/lnkproducer/openit.lnk?path=/repository/workspace/somenode/somefile.extention</uri>
  </para>

  <note>
  <para>When using the portal mode the REST servlet is
  available using a reference (href) like
  <uri>http://localhost:8080/portal/rest/...</uri></para>
 </note>

  <para>The name of the <filename>.lnk</filename> file can be any. But for the best compatibility,
  it must be the same as the name of the JCR resource.</para>

  <para>Here is a step-by-step sample of a usecase of the link producer. First, type the valid reference to the resource using the link producer in your
  browser's address field:</para>

  <mediaobject>
    <imageobject>
      <imagedata fileref="images/other/lnkproducer1.JPG" />
    </imageobject>
  </mediaobject>

  <para>Internet Explorer will give a dialog window requesting to <emphasis role="bold">Open a file</emphasis> or to <emphasis role="bold">Save it</emphasis>. Click the <guibutton>Open</guibutton> button.</para>

  <mediaobject>
    <imageobject>
      <imagedata fileref="images/other/lnkproducer2.JPG" />
    </imageobject>
  </mediaobject>

  <para>In Windows system an <filename>.lnk</filename> file will be downloaded and opened with the
  application which is registered to open the files, which are pointed to by
  the <filename>.lnk</filename> file. In case of a <filename>.doc</filename> file, Windows opens Microsoft Office Word
  which will try to open a remote file (<filename>test0000.doc</filename>). Maybe, it will be
  necessary to enter USERNAME and PASSWORD.</para>

  <mediaobject>
    <imageobject>
      <imagedata fileref="images/other/lnkproducer3.JPG" />
    </imageobject>
  </mediaobject>

  <para>Next, you will be able to edit the file in Microsoft Word.</para>

  <mediaobject>
    <imageobject>
      <imagedata fileref="images/other/lnkproducer4.JPG" />
    </imageobject>
  </mediaobject>

  <para>The Link Producer is necessary for opening/editing and then saving the
  remote files in Microsoft Office Word without any further updates.</para>

  <para>Also, the Link Producer can be referenced to from an HTML page. If page
  contains code like:</para>

  <programlisting language="html">&lt;a href="http://localhost:8080/rest/lnkproducer/openit.lnk?path=/repository/workspace/somenode/somefile.extention"&gt;somefile.extention&lt;/a&gt;</programlisting>

  <para>The <filename>somefile.extention</filename> file will open directly.</para>
</section>
